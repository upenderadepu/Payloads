
#### 1. Path/Directory Traversal

##### What is?
* Path traversal is also known as directory traversal. These vulnerabilities enable an attacker to read arbitrary files on the server that is running an application.

##### Payload
* `/var/www/images/../../../etc/passwd`

#### How to fix?

* Validate user supplied input.
* Avoid passing user-supplied input to filesystem APIs altogether.

---

#### 2. Access Control vulns

##### What is?
* Access control is the application of constraints on who or what is authorized to perform actions or access resources.
* **Authentication** confirms that the user is who they say they are.
- **Session management** identifies which subsequent HTTP requests are being made by that same user.
- **Access control** determines whether the user is allowed to carry out the action that they are attempting to perform.

1. Vertical access controls
	*  Vertical access controls are mechanisms that restrict access to sensitive functionality to specific types of users.

2. Horizontal access controls
	* Horizontal access controls are mechanisms that restrict access to resources to specific users.


---

#### 3. Insecure Direct Object Reference

##### What is?
* Insecure direct object references (IDOR) are a type of access control vulnerability that arises when an application uses user-supplied input to access objects directly.


##### How to fix?

* Never rely on obfuscation alone for access control.
- Unless a resource is intended to be publicly accessible, deny access by default.
- At the code level, make it mandatory for developers to declare the access that is allowed for each resource, and deny access by default.

---

#### 4. Authentication Vulnerabilities

##### What is?
* Authentication is the process of verifying the identity of a user or client.
* 3 main types
	1. Something you **know**, such as a password or the answer to a security question.
	2. Something you **have**, This is a physical object such as a mobile phone or security token.
	3. Something you **are** or do. For example, your biometrics or patterns of behavior.

##### Difference b/w Authn & Authz

* Authentication is the process of verifying that a user is who they claim to be. Authorization involves verifying whether a user is allowed to do something.


##### OAuth vulns

##### What is?

* OAuth is a commonly used authorization framework that enables websites and web applications to request limited access to a user's account on another application.

##### How does OAuth 2.0 work?

* **Client application** - The website or web application that wants to access the user's data.
- **Resource owner** - The user whose data the client application wants to access.
- **OAuth service provider** - The website or application that controls the user's data and access to it. They support OAuth by providing an API for interacting with both an authorization server and a resource server.


##### How to fix?

* Take care with user credentials
* Prevent Username Enumeration
* Implement robust brute-force protection
* Implement 2FA

---

#### 5. Server-side request forgery (SSRF)

##### What is?
* Server-side request forgery is a web security vulnerability that allows an attacker to cause the server-side application to make requests to an unintended location.

##### Common Attacks

* 1. Attacks against the server
	- the attacker causes the application to make an HTTP request back to the server that is hosting the application. such as loopback `127.0.0.1`
* 2. Attacks against other back-end systems
	* These systems often have non-routable private IP addresses. The application server is able to interact with back-end systems.
* 3. SSRF with blacklist-based & whitelist-based input filters
	* *Bypasses*
		1. embed credentials in a URL before the hostname
		2. use the `#` character to indicate a URL fragment.
		3. use alternative IP representation
		4. register domain name that resolves to `127.0.0.1`
		5. Use different `scheme`, URL encoding & case variation.
* 4. Bypass Validation with OpenRedirect vuln.
* 5. SSRF via referer header
* 6. Partial URL in requests - an application places only a hostname or part of a URL path into request parameters.

##### What is Blind SSRF?
* Blind SSRF vulnerabilities arise when an application can be induced to issue a back-end HTTP request to a supplied URL, but the response from the back-end request is not returned in the application's front-end response.

---

#### 6. File Upload Vulnerabilities


#### What is?
* File upload vulnerabilities are when a web server allows users to upload files to its filesystem without sufficiently validating things like their name, type, contents, or size.

##### Exploiting unrestricted file uploads to deploy a web shell

---

#### 7. OS Command Injection

##### What is?
* OS command injection is also known as shell injection. It allows an attacker to execute operating system (OS) commands on the server that is running an application, and typically fully compromise the application and its data.

##### Blind OS Command injection

* When injection is getting successful but we are not receiving any response from the server/OS.

##### How to fix?

* Never Call out to OS Commands Injection.
* Validating against a whitelist of permitted values.
- Validating that the input is a number.
- Validating that the input contains only alphanumeric characters, no other syntax or whitespace.

---

#### 7. SQL Injection

##### What is?
* SQL injection (SQLi) is a web security vulnerability that allows an attacker to interfere with the queries that an application makes to its database. This can allow an attacker to view data that they are not normally able to retrieve.

##### How to detect?

* single character `'`
* Some SQL-specific syntax that evaluates to the base (original) value of the entry point.
* Boolean conditions such as `OR 1=1` and `OR 1=2`,
* Payloads designed to trigger time delays when executed within a SQL query
* [OAST](https://portswigger.net/burp/application-security-testing/oast) payloads designed to trigger an out-of-band network interaction when executed within a SQL query.

##### Types of SQL Injection

1. In-band SQLi (Classic SQLi)
		1. Error Based
		2. Union-based SQLi
2. Blind SQLi
	1. Boolean-based
	2. Time-based
3. Out-of-band SQLi
##### SQL injection UNION attacks

* When an application is vulnerable to SQL injection, and the results of the query are returned within the application's responses, you can use the `UNION` keyword to retrieve data from other tables within the database.

For a `UNION` query to work, two key requirements must be met:
- The individual queries must return the same number of columns.
- The data types in each column must be compatible between the individual queries.

* To carry out a SQL injection UNION attack, make sure that your attack meets these two requirements.

##### Blind SQL Injection

* Blind SQL injection occurs when an application is vulnerable to SQL injection, but its HTTP responses do not contain the results of the relevant SQL query or the details of any database errors.

##### Error Based SQL Injection

* Error-based SQL injection refers to cases where you're able to use error messages to either extract or infer sensitive data from the database, even in blind contexts.


##### How to Fix it?
* You can use parameterized queries for any situation where untrusted input appears as data within the query, including the `WHERE` clause and values in an `INSERT` or `UPDATE` statement.


---

#### 8. Server-Side Template Injection

##### What is?
* Server-side template injection is when an attacker is able to use native template syntax to inject a malicious payload into a template, which is then executed server-side.

* Server-side template injection attacks can occur when user input is concatenated directly into a template, rather than passed in as data.

##### How to find?

* Detect -> Identify -> Exploit

---

#### 9. Server-Side Parameter Pollution

##### What is?
* Server-side parameter pollution occurs when a website embeds user input in a server-side request to an internal API without adequate encoding.

##### How to find?

* This means that an attacker may be able to manipulate or inject parameters, which may enable them to, for example:

- Override existing parameters.
- Modify the application behavior.
- Access unauthorized data.

1. Inject `#, &, =` in the request parameters and observe the response.

##### How to fix?

* Encode and don't allow query syntax parameters.

---
#### 10. Insecure Deserialization

##### What is?
* Insecure deserialization is when user-controllable data is deserialized by a website. This potentially enables an attacker to manipulate serialized objects in order to pass harmful data into the application code.

* During auditing, you should look at all data being passed into the website and try to identify anything that looks like serialized data.

##### PHP/JAVA and many more

* Identification of insecure deserialization can be done by looking at how serialized data has been passed in the some format for languages.